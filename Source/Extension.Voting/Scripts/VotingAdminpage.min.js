function showInfoDialog(){VSS.require("VSS/Controls/Dialogs",function(n){n.show(n.ModalDialog,{title:"Help",contentText:"During a running voting you can edit 'Title' and 'Description' of the voting.\nTo change another property you have to stop the actual voting and create a new one",buttons:[]})})}function generateCombos(){VSS.require(["VSS/Controls","VSS/Controls/Combos"],function(n,t){var i=n.create(t.Combo,$("#titleContainer"),{type:"list",label:"Provide a title for the voting (required)",mode:"text",enabled:!0,value:"",invalidCss:"invalid",change:function(){this.getText()==""?this.setInvalid(!0):(this.setInvalid(!1),adminpage.setTitle(this.getText()))}}),r=n.create(t.Combo,$("#descriptionContainer"),{type:"list",label:"Provide a description for the voting (optional)",mode:"text",value:"",enabled:!0,change:function(){adminpage.setDescription(this.getText())}}),u=n.create(t.Combo,$("#multipleVotesContainer"),{type:"list",mode:"drop",source:["Disabled","Enabled"],value:"Disabled",allowEdit:!1,enabled:!0,indexChanged:function(){var n=this.getText()=="Enabled";adminpage.setMultipleVotes(n)},disabledCss:"readOnly"}),f=n.create(t.Combo,$("#levelContainer"),{type:"list",mode:"drop",allowEdit:!1,enabled:!0,change:function(){adminpage.setLevel(this.getText())},disabledCss:"readOnly"});adminpage.setCombos(i,r,u,f)})}function toggleActive(){$("#content").toggleClass("hide")}function appendAppVersion(){$("#appVersion").text(VSS.getExtensionContext().version)}function addToIncludes(n){n.preventDefault();var t=n.dataTransfer.getData("text");$("#includeListbody").append(document.getElementById(t));adminpage.addToIncludeList($("#"+t).children(".panel-body").text())}function addToExcludes(n){n.preventDefault();var t=n.dataTransfer.getData("text");$("#excludeListbody").append(document.getElementById(t));adminpage.addToExcludeList($("#"+t).children(".panel-body").text())}function startDrag(n){n.dataTransfer.setData("text",n.target.id)}function onDragOver(n){n.preventDefault()}function createMenueBar(n){$("#menueBar-container").empty();VSS.require(["VSS/Controls","VSS/Controls/Menus"],function(t,i){var r=t.create(i.MenuBar,$("#menueBar-container"),{showIcon:!0,items:adminpage.getMenuItems(n),executeAction:function(n){var r=n.get_commandName(),t,i;switch(r){case"createVoting":adminpage.votingEnabledClicked();$("#errorMessage").toggleClass("hide",!0);break;case"createNewVoting":t=VSS.getWebContext();i=VSS.getExtensionContext();appInsights.trackEvent("Create voting",{ExtensionId:i.extensionId,Account:t.account.name,TeamProject:t.project.id});case"saveSettings":adminpage.saveClicked("true");break;case"infoButton":adminpage.showInfo();break;case"cancelVoting":adminpage.cancelClicked();break;case"terminateVoting":adminpage.saveClicked("false");break;case"excludeList":adminpage.loadExcludeList();$("#excludeModal").modal();break;case"applyToBacklog":adminpage.applyClicked()}}})})}var adminpage;$(document).ready(function(){LogExtension.debugEnabled=!1;try{VSS.init({usePlatformStyles:!0,usePlatformScripts:!0});VSS.ready(function(){LogExtension.log("VSS ready");VSS.require(["VSS/Controls","VSS/Controls/StatusIndicator"],function(n,t){var i=n.create(t.WaitControl,$("#waitContainer"),{message:"Loading..."});LogExtension.log("Waitcontrol ready","start application");adminpage=new AdminpageMain(i);LogExtension.log("Events ready");$("#appVersion").text(VSS.getExtensionContext().version)})})}catch(n){LogExtension.log(n)}$(document).bind("ajaxSend",function(){$("#progressBar").show()}).bind("ajaxComplete",function(){$("#progressBar").hide()})})