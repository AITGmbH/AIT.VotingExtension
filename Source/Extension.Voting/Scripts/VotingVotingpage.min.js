function createVotingTable(){VSS.require(["VSS/Controls","VSS/Controls/Grids"],function(n,t){var i=n.create(t.Grid,$("#grid-container"),{height:"400px",allowMultiSelect:!1,columns:[{title:"Vote up",id:"voteUp",canSortBy:!1,width:20,getCellContents:function(){var n='<div class="grid-cell grid-buttonVoteUp-holder" role="gridcell" style="width: 20px;">';return n+='<span class="upvote-holder">',n+='<span class="icon icon-add voting-plus hide" aria-hidden="true" onClick="VotingpageMain.voteUpClicked(this)"><\/span>',n+="<\/span><\/div>",$(n)}},{title:"Vote down",id:"voteDown",canSortBy:!1,width:20,getCellContents:function(){var n='<div class="grid-cell grid-buttonVoteDown-holder" role="gridcell" style="width: 20px;">';return n+='<span class="downvote-holder">',n+='<span class="icon icon-delete voting-remove hide" aria-hidden="true" onClick="VotingpageMain.voteDownClicked(this)"><\/span>',n+="<\/span><\/div>",$(n)}},{title:"Work Item ID",text:"ID",index:"id",width:50,id:"itemId"},{title:"Work Item Type",text:"Work Item Type",index:"workItemType",width:100},{title:"Work Item Title",text:"Title",index:"title",width:200},{title:"Assigned team member",text:"Assigned To",index:"assignedTo",width:125},{title:"Work Item State",text:"State",index:"state",width:100},{title:"All votes per item",text:"Votes",index:"allVotes",width:60},{title:"My Votes per item",text:"My Votes",index:"myVotes",width:60},{text:"Order",index:"order",width:50,hidden:!0}],openRowDetail:function(n){var t=i.getRowData(n);VSS.require(["TFS/WorkItemTracking/Services"],function(n){n.WorkItemFormNavigationService.getService().then(function(n){n.openWorkItem(t.Id)})})},sortOrder:[{index:"allVotes",order:"desc"},{index:"order",order:"asc"}],autoSort:!0});VotingpageMain.setGrid(i);insertionQ(".grid-row").every(function(n){var f=$(n).find("div:nth-child(1)"),e=$(n).find("div:nth-child(2)"),o=$(n).find("div:nth-child(3)"),s=$(n).find("div:nth-child(4)"),t=$(n).find("div:nth-child(5)"),i=$(n).find("div:nth-child(6)"),h=$(t).text(),c=$(s).text().toLowerCase().replace(/\s+/g,""),l=parseEmail($(i).text()),r,u;$(t).text("");$(t).append('<div class="work-item-color '+c+'-color">&nbsp;<\/div>');$(t).append("<span>"+h+"<\/span>");$(i).text(l);r=$(f).find("span > span.icon");u=$(e).find("span > span.icon");VotingpageMain.initializeItem($(o).text(),r,u)})})}function parseEmail(n){var t=/(.+?)\s<[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,6}>/i.exec(n);return t!=null?t[1]:n}function createVotingMenue(){VSS.require(["VSS/Controls","VSS/Controls/Menus"],function(n,t){var i=n.create(t.MenuBar,$("#votingMenue-container"),{showIcon:!0,items:[{id:"refresh",title:"Refresh voting table",icon:"icon icon-refresh",disabled:!1},{id:"applyToBacklog",title:"Apply to Backlog",icon:"icon icon-tfs-query-edit",disabled:!1},{separator:!0},{id:"adminpageLink",title:"Visit settings page",icon:"icon icon-settings",disabled:!1},{separator:!0},{id:"removeAllUserdata",title:"Delete user data from storage.",icon:"icon icon-delete",disabled:!1}],executeAction:function(n){var i=n.get_commandName(),t;switch(i){case"applyToBacklog":VotingpageMain.applyClicked();break;case"adminpageLink":t=VotingpageMain.getAdminpageUri();window.open(t,"_blank");break;case"refresh":VotingpageMain.refreshTable();break;case"removeAllUserdata":VotingpageMain.removeAllUserdata()}}});$("#votingMenue-container").toggleClass("hide",!1)})}$(document).ready(function(){LogExtension.debugEnabled=!1;try{VSS.init({usePlatformStyles:!0,usePlatformScripts:!0});VSS.ready(function(){LogExtension.log("VSS ready");VSS.require(["VSS/Controls","VSS/Controls/StatusIndicator"],function(n,t){var i=n.create(t.WaitControl,$("#waitContainer"),{message:"Loading..."});LogExtension.log("Waitcontrol ready","start application");VotingpageMain.startApplication(i)})})}catch(n){LogExtension.log(n)}$(document).bind("ajaxSend",function(){$("#progressBar").show()}).bind("ajaxComplete",function(){$("#progressBar").hide()})})